<script setup lang="ts">
import { computed, onMounted, ref } from 'vue'
import { useVulnerabilities, useVulnerabilitiesDetails } from '@composables/useVulnerabilities'
import { STATE_VULNERABILITY } from '@/constants'

const { data, loading, error, fetchVulnerabilityDetails } = useVulnerabilitiesDetails()

const props = defineProps<{
    idVulnerability: string
}>()
onMounted(async () => {
    await fetchVulnerabilityDetails(props.idVulnerability)
})
const selectedVulnerability = computed(() => data.value)

const vulnStatus = computed(() => {
    return STATE_VULNERABILITY[selectedVulnerability.value?.vuln_status] || 'Desconocido'
})
</script>

<template>
    <div v-if="data">
        <p><strong>CVE ID:</strong> {{ selectedVulnerability.cve_id }}</p>
        <p><strong>Descripción:</strong> {{ selectedVulnerability.description }}</p>
        <p><strong>Fecha de publicación:</strong> {{ selectedVulnerability.published }}</p>
        <p><strong>Fecha de actualización:</strong> {{ selectedVulnerability.last_modified }}</p>
        <p><strong>Estado:</strong> {{ vulnStatus }}</p>
        <p><strong>Solucionado:</strong> {{ selectedVulnerability.fixed ? '✅' : '❌' }}</p>
    </div>
</template>
